<nz-spin nzTip="loading..." [nzSpinning]="isLoading">

  <nz-input-group *ngIf="config.showSearch" [nzSuffix]="suffixIcon" style="width: 100%;">
    <input type="text" nz-input placeholder="查询" [(ngModel)]="searchValue" />
  </nz-input-group>
  <ng-template #suffixIcon>
    <i nz-icon nzType="search"></i>
  </ng-template>

  <nz-tree #treeObj [nzData]="nodes" [nzAsyncData]="config.async" [nzExpandAll]="config.expandAll"
    [nzCheckStrictly]="config.checkStrictly" [nzCheckable]="config.showCheckBox" [nzShowLine]="config.showLine"
    (nzClick)="clickNode($event)" (nzExpandChange)="expandNode($event)" [nzTreeTemplate]="nzTreeTemplate"
    [nzSearchValue]="searchValue" (nzSearchValueChange)="nzEvent($event)"  [nzSelectedKeys]="defaultSelectedKeys">
  </nz-tree>
  <!--  -->
   <ng-template #nzTreeTemplate let-node>
    <span   class="custom-node" [class.active]="ACTIVED_NODE?.key === node.key">
      <span 
      (cdkDragStarted)="dragStarted($event)"
      (cdkDragEnded)="dragEnded($event)"
      (cdkDragMoved)="dragMoved($event)" 
      cdkDrag [cdkDragData]="node"
      (cdkDragEntered)="dragEntered($event)" (cdkDragExited)="dragExited($event)" 
      *ngIf="!node.isLeaf">
        <i nz-icon [nzType]="node.isExpanded ? 'folder-open' : 'folder'" (click)="openFolder(node)"></i>
        <ng-container *ngIf="node.isMatched">
          <span class="file-name"> {{searchTargetString(node.title)[0]}}</span>
          <span class="highlight"> {{searchTargetString(node.title)[1]}} </span>
          <span class="file-name">{{searchTargetString(node.title)[2]}}</span> 
        </ng-container>
        <ng-container *ngIf="!node.isMatched">
          <span class="file-name">{{ node.title }}</span>
        </ng-container>
        <span class="folder-desc" *ngIf="config.desc">{{ node?.origin[config.desc] }}</span>
      </span>
      <span cdkDrag (cdkDragStarted)="dragStarted($event)"
      (cdkDragEnded)="dragEnded($event)"
      (cdkDragMoved)="dragMoved($event)" [cdkDragData]="node" *ngIf="node.isLeaf">
        <i nz-icon nzType="file"></i>
        <ng-container *ngIf="node.isMatched">
         
          <span class="file-name"> {{searchTargetString(node.title)[0]}}</span>
          <span class="highlight"> {{searchTargetString(node.title)[1]}} </span>
          <span class="file-name">{{searchTargetString(node.title)[2]}}</span>
          
        </ng-container>
        <ng-container *ngIf="!node.isMatched">
          <span class="file-name">{{ node.title }}</span>
        </ng-container>

        <span class="file-desc" *ngIf="config.desc">{{ node?.origin[config.desc] }}</span>
      </span>
    </span>
  </ng-template> 

</nz-spin>

